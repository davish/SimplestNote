var crypto = require("crypto");

function createSalt () {
  var letters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");
  var salt = []
  for (var i = 0; i < 5; i++) {
    salt.push(letters[Math.round(Math.random() * 51)])
  }

  return salt.join("");
}

exports.makePswdHash = function(name, pw, salt) {
  if (!salt) {
    salt = createSalt();
  }

  h = crypto.createHash("sha256");
  h.update(name);
  h.update(pw);
  h.update(salt);

  return h.digest("hex") + "," + salt;
}